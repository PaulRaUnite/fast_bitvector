open! Expect_test_helpers_core
open! Sexplib0.Sexp_conv

let%expect_test "Basic" =
  let a, b = Fast_bitvector.create ~length:100, Fast_bitvector.create ~length:100 in
  print_s [%message "" (a : Fast_bitvector.t) (b : Fast_bitvector.t)];
  [%expect {|
    ((a
      0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)
     (b
      0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000))
    |}];
  Fast_bitvector.set a 0;
  print_s [%message "" (a : Fast_bitvector.t)];
  [%expect {|
    (a
     0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001)
    |}];
  Fast_bitvector.set a 99;
  print_s [%message "" (a : Fast_bitvector.t)];
  [%expect {|
    (a
     1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001)
    |}];
  Fast_bitvector.not ~result:b a |> ignore;
  print_s [%message "" (a : Fast_bitvector.t) (b : Fast_bitvector.t)];
  [%expect {|
    ((a
      1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001)
     (b
      0111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110))
    |}];
  Fast_bitvector.set_all a;
  Fast_bitvector.clear_all b;
  print_s [%message "" (a : Fast_bitvector.t) (b : Fast_bitvector.t)];
  [%expect {|
    ((a
      1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111)
     (b
      0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000))
    |}];
  ()
